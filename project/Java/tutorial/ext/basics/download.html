<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
    <head>
        <title>Download Extensions (The Java&trade; Tutorials &gt; 
            The Extension Mechanism &gt; Creating and Using Extensions)
</title>
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #E76F00;
        font-family: sans-serif; 
        font-weight: bold;
        font-size: 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;
        font-size: smaller;
        font-family: sans-serif; 
    }
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #E76F00;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h3, h4, h5 {
        color: #E76F00;
        font-family: sans-serif;
    }
    #ToggleLeft {
        display: none;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> The Extension Mechanism
        <br><b>Lesson:</b> Creating and Using Extensions
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">Creating and Using Extensions</a></div>
<div class="linkAHEAD"><a href="install.html">Installed Extensions</a></div>
<div class="nolinkAHEAD">Download Extensions</div>
<div class="linkAHEAD"><a href="load.html">Understanding Extension Class Loading</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>The Extension Mechanism</a>
                &gt;
                <a href=index.html target=_top>Creating and Using Extensions</a>
            </span>
            <div class=NavBit>
                <a target=_top href=install.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=load.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle>Download Extensions</div>
            <blockquote>
Download extensions are sets of classes (and related resources) in JAR files.

A JAR file's manifest can contain headers that refer to one or more download extensions.

The extensions can be referenced in one of two ways:
<ul>
<li>by a <tt>Class-Path</tt> header</li>
<li>by an <tt>Extension-List</tt> header</li>
</ul>

Note that at most one of each is allowed in a manifest.

Download extensions indicated by a <tt>Class-Path</tt> header are downloaded
only for the lifetime of the application that downloads them, such as a web
browser.

Their advantage is that nothing is installed on the client; their disadvantage
is that they are downloaded each time they are needed.

Download extensions that are downloaded by an <tt>Extension-List</tt> header are
installed into the <tt>/lib/ext</tt> directory of the JRE that downloads them.

Their advantage is that they are downloaded the first time they're needed;
subsequently they can be used without downloading.

But as shown later in this tutorial, they are more complex to deploy.

<p>

Since download extensions that use the <tt>Class-Path</tt> headers are
simpler, lets consider them first.

Assume for example that <tt>a.jar</tt> and <tt>b.jar</tt> are 
two JAR files in the same directory, and that the manifest of <tt>a.jar</tt> 
contains this header:
<blockquote><pre>
Class-Path: b.jar
</pre></blockquote>
Then the classes in <tt>b.jar</tt> serve as extension classes for purposes 
of the classes in <tt>a.jar</tt>.  The classes in <tt>a.jar</tt> can invoke classes in 
<tt>b.jar</tt> without <tt>b.jar</tt>'s classes having to be  
named on the class path. <tt>a.jar</tt> may or may not itself be an extension.
If <tt>b.jar</tt> weren't in the same directory as <tt>a.jar</tt>, then 
the value of the <tt>Class-Path</tt> header should be set to the relative 
pathname of <tt>b.jar</tt>.
<p>
There's nothing special about the classes that are playing 
the role of a download extension.  They are treated as extensions solely 
because they're referenced by the manifest of some other JAR file.
<p>
To get a better understanding of how download extensions work, let's 
create one and put it to use.



</blockquote>
<h3>An Example</h3>
<blockquote>
Suppose you want to create an applet that makes use of the 
<code>RectangleArea</code> class of the previous 
section:
<blockquote><pre>
public final class RectangleArea {  
    public static int area(java.awt.Rectangle r) {
        return r.width * r.height;
    }
}
</pre></blockquote>

In the previous section, you made the <tt>RectangleArea</tt> class
into an installed extension by placing the JAR file containing it into 
the <tt>lib/ext</tt> directory of the JRE.  By making it an installed 
extension, you enabled any application to use the <tt>RectangleArea</tt> 
class as if it were part of the Java platform.
<p>
If you want to be able to use the <tt>RectangleArea</tt> class from an 
applet, the situation is a little different.  Suppose, for example, 
that you have an applet, <code>AreaApplet</code>, that makes use of class 
<tt>RectangleArea</tt>:
<blockquote><pre>
import java.applet.Applet;
import java.awt.*;

public class AreaApplet extends Applet {
    Rectangle r;

    public void init() {    
        int width = 10;
        int height = 5;

        r = new Rectangle(width, height);
    }

    public void paint(Graphics g) {
        g.drawString("The rectangle's area is " 
                      + RectangleArea.area(r), 10, 10);
    }
}
</pre></blockquote>
This applet instantiates a 10 <var>x</var> 5 rectangle and then displays 
the rectangle's area by using the <tt>RectangleArea.area</tt> method. 
<p>
However, you can't assume that everyone 
who downloads and uses your applet is going to have the <tt>RectangleArea</tt> 
class available on their system, as an installed extension or 
otherwise. One way around that problem is 
to make the <tt>RectangleArea</tt> class available from the server side, 
and you can do that by using it as a download extension.
<p>
To see how that's done, let's assume that you've bundled 
<code>AreaApplet</code> in a 
JAR file called <tt>AreaApplet.jar</tt> and that the class 
<tt>RectangleArea</tt> is bundled in <tt>RectangleArea.jar</tt>. In order for 
<tt>RectangleArea.jar</tt> to be treated as a download extension, 
<tt>RectangleArea.jar</tt> must be listed in the
<tt>Class-Path</tt> header in <tt>AreaApplet.jar</tt>'s manifest. 
<tt>AreaApplet.jar</tt>'s manifest might look like this, for example:
<blockquote><pre>
Manifest-Version: 1.0
Class-Path: RectangleArea.jar
</pre></blockquote>
The value of the <tt>Class-Path</tt> header in this manifest is 
<tt>RectangleArea.jar</tt> with no path specified, indicating that 
<tt>RectangleArea.jar</tt> is located in the same directory as the applet's 
JAR file.
</blockquote>


<h3>More about the Class-Path Header</h3>
<blockquote>
If an applet or application uses more than one extension, you can list 
multiple URLs in a manifest. For example, the following is a valid header:
<blockquote><pre>
Class-Path: area.jar servlet.jar images/
</pre></blockquote>
In the <tt>Class-Path</tt> header any URLs listed  
that don't end with '<tt>/</tt>' are assumed to be JAR files. URLs 
ending in '<tt>/</tt>' indicate directories. In the 
preceding example, <tt>images/</tt> might be a directory containing 
resources needed by the applet or the application.
<p>
Note that only one <tt>Class-Path</tt> header is allowed in a manifest file, and that
each line in a manifest must be no more than 72 characters long.  If you need to
specify more class path entries than will fit on one line, you can extend them
onto subsequent continuation lines.  Begin each continuation line with two
spaces.  For example:
<blockquote><pre>
Class-Path: area.jar servlet.jar monitor.jar datasource.jar
  provider.jar gui.jar
</pre></blockquote>
A future release may remove the limitation of having only one instance of each
header, and of limiting lines to only 72 characters.
<p>
Download extensions can be "daisy chained", meaning that the manifest of 
one download extension can have a <tt>Class-Path</tt> header that 
refers to a second extension, which can refer to a third extension, and so on.


</blockquote>
<h3>Installing Download Extensions</h3>
<blockquote>
In the above example, the extension downloaded by the applet is available only
while the browser which loaded the applet is still running.

However, applets can trigger installation of extensions, if additional
information is included in the manifests of both the applet and the extension.
<p>

Since this mechanism extends the platform's core API, its use
should be judiciously applied.  It is rarely appropriate for interfaces used
by a single, or small set of applications.  All visible symbols should follow
reverse domain name and class hierarchy conventions.
<p>

The basic requirements are that both the applet and the extensions it uses
provide version information in their manifests, and that they be signed.

The version information allows Java Plug-in to ensure that the extension
code has the version expected by the applet.  For example, the
<tt>AreaApplet</tt> could specify an <tt>areatest</tt> extension in its
manifest:

<blockquote><pre>
Manifest-Version: 1.0
Extension-List: areatest
areatest-Extension-Name: area
areatest-Specification-Version: 1.1
areatest-Implementation-Version: 1.1.2
areatest-Implementation-Vendor-Id: com.sun
areatest-Implementation-URL: http://www.sun.com/test/area.jar
</pre></blockquote>


(Please note that there is no <tt>area.jar</tt> file at the above URL;
this is just an example!)

The manifest in <tt>area.jar</tt> would provide corresponding information:

<blockquote><pre>
Manifest-Version: 1.0
Extension-Name: area
Specification-Vendor: Sun Microsystems, Inc
Specification-Version: 1.1
Implementation-Vendor-Id: com.sun
Implementation-Vendor: Sun Microsystems, Inc
Implementation-Version: 1.1.2
</pre></blockquote>

Both the applet and the extension must be signed, by the same signer.

Signing the jar files will modify them in-place, providing more information in
their manifest files.

Signing helps ensure that only trusted code gets installed.

A simple way to sign jar files is to first create a keystore, and then
use that to hold certificates for the applet and extension.

For example:

<blockquote><pre>
keytool -genkey -dname "cn=Fred" -alias test -keypass mykeypass -storepass mystorepass -validity 180
</pre></blockquote>

Then the jar files can be signed:

<blockquote><pre>
jarsigner -storepass mystorepass -keypass mykeypass AreaApplet.jar test
jarsigner -storepass mystorepass -keypass mykeypass area.jar test
</pre></blockquote>

More information on <tt>keytool</tt>, <tt>jarsigner</tt>, and other security
tools is at the 
<a class="OutsideLink" target="_blank" href="http://java.sun.com/javase/6/docs/technotes/guides/security/SecurityToolsSummary.html">Summary of Tools for the Java 2 Platform Security</a>.

<p>

Here is <tt>AreaDemo.html</tt>, which loads the applet and causes the
extension code to be downloaded and installed:

<blockquote>
<pre>
&lt;html&gt;
&lt;body&gt;
  &lt;applet code="AreaApplet.class" archive="AreaApplet.jar"/&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</blockquote>


When the page is loaded for the first time, the user is told that the applet
requires installation of the extension.

A subsequent dialog informs the user about the signed applet.

Accepting both installs the extension in the <tt>lib/ext</tt> folder
of the JRE and runs the applet.

<p>

After restarting the web browser and load the same web page, only the dialog
about the applet's signer is presented, because <tt>area.jar</tt> is already installed.

This is also true if <tt>AreaDemo.html</tt> is opened in a different web
browser (assuming both browsers use the same JRE).

<p>

For more information about installing download extensions, please see
<a class="OutsideLink" target="_blank" href="http://java.sun.com/javase/6/docs/technotes/guides/plugin/developer_guide/extensions.html">Deploying Java Extensions</a>.
A more detailed example is at
<a class="TutorialLink" target="_top" href="http://java.sun.com/javase/6/docs/technotes/guides/plugin/developer_guide/extensions_example.html">Deploying Java Media Framework as Java Extension</a>.
        </blockquote>
        <div class=NavBit>
            <a target=_top href=install.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=load.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer>
<div id=TagNotes>
    Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://developer.sun.com/contact/tutorial_feedback.jsp">Give
    us your feedback</a>.
<br><br>
    <a target="_blank" href="../../information/copyright.html">Copyright</a>
    1995-2007 Sun Microsystems, Inc.  All rights reserved.
    <span id=Download>
</span></div> 

    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Installed Extensions
        <br><b>Next page:</b> Understanding Extension Class Loading
    </div>
    </body>
</html> 
