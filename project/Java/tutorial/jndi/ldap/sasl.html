



<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
    <head>
        <title>SASL (The Java&trade; Tutorials &gt; 
            Java Naming and Directory Interface(TM). &gt; Advanced Topics for LDAP Users)
</title>
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #E76F00;
        font-family: sans-serif; 
        font-weight: bold;
        font-size: 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;
        font-size: smaller;
        font-family: sans-serif; 
    }
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #E76F00;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h3, h4, h5 {
        color: #E76F00;
        font-family: sans-serif;
    }
    #ToggleLeft {
        display: none;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> Java Naming and Directory Interface(TM).
        <br><b>Lesson:</b> Advanced Topics for LDAP Users
        <br><b>Section:</b> Security
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">Advanced Topics for LDAP Users</a></div>
<div class="linkAHEAD"><a href="ldap.html">LDAP v3</a></div>
<div class="linkAHEAD"><a href="jndi.html">JNDI as an LDAP API</a></div>
<div class="linkBHEAD"><a href="operations.html">How LDAP Operations Map to JNDI APIs</a></div>
<div class="linkBHEAD"><a href="exceptions.html">How LDAP Error Codes Map to JNDI Exceptions</a></div>
<div class="linkAHEAD"><a href="security.html">Security</a></div>
<div class="linkBHEAD"><a href="authentication.html">Modes of Authenticating to LDAP</a></div>
<div class="linkBHEAD"><a href="auth_mechs.html">Authentication Mechanisms</a></div>
<div class="linkBHEAD"><a href="anonymous.html">Anonymous</a></div>
<div class="linkBHEAD"><a href="simple.html">Simple</a></div>
<div class="nolinkBHEAD">SASL</div>
<div class="linkBHEAD"><a href="digest.html">Digest-MD5</a></div>
<div class="linkBHEAD"><a href="ssl.html">SSL and Custom Sockets</a></div>
<div class="linkAHEAD"><a href="rename.html">More LDAP Operations</a></div>
<div class="linkBHEAD"><a href="compare.html">LDAP Compare</a></div>
<div class="linkBHEAD"><a href="result.html">Search Results</a></div>
<div class="linkBHEAD"><a href="unsol.html"> LDAP Unsolicited Notifications</a></div>
<div class="linkAHEAD"><a href="connect.html">Connection Management</a></div>
<div class="linkBHEAD"><a href="create.html">Creation</a></div>
<div class="linkBHEAD"><a href="close.html"> Closing</a></div>
<div class="linkBHEAD"><a href="pool.html">Pooling</a></div>
<div class="linkBHEAD"><a href="config.html">Configuration</a></div>
<div class="linkAHEAD"><a href="faq.html">Frequently Asked Questions</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>Java Naming and Directory Interface(TM).</a>
                &gt;
                <a href=index.html target=_top>Advanced Topics for LDAP Users</a>
            </span>
            <div class=NavBit>
                <a target=_top href=simple.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=digest.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle>SASL</div>
            <blockquote>
The LDAP v3 protocol uses the 
<A HREF="http://ietf.org/rfc/rfc2222.txt">SASL</A>
to support <em>pluggable</em> authentication.
This means that the LDAP client and server can be configured
to negotiate and use possibly nonstandard and/or customized mechanisms
for authentication, depending on the level of protection
desired by the client and the server.
The LDAP v2 protocol does not support the SASL.
<p>
Several SASL mechanisms are currently defined:
<ul>
<li>Anonymous (<A HREF="http://ietf.org/rfc/rfc2245.txt">RFC 2245</a>)
<li>CRAM-MD5 (<A HREF="http://ietf.org/rfc/rfc2195.txt">RFC 2195</a>)
<li>Digest-MD5 
(<a href="http://ietf.org/rfc/rfc2831.txt">RFC 2831</a>)
<li>External (<A HREF="http://ietf.org/rfc/rfc2222.txt">RFC 2222</A>)
<li>Kerberos V4 (<A HREF="http://ietf.org/rfc/rfc2222.txt">RFC 2222</A>)
<li>Kerberos V5 (<A HREF="http://ietf.org/rfc/rfc2222.txt">RFC 2222</A>)
<li>SecurID (<a href="http://ietf.org/rfc/rfc2808.txt">RFC 2808</a>)
<li>S/Key (<A HREF="http://ietf.org/rfc/rfc2222.txt">RFC 2222</A>)
</ul>

<h4>SASL Mechanisms Supported by LDAP Servers</h4>

Of the mechanisms on the previous list, popular LDAP servers (such as those from 
<a href=http://www.sun.com>Sun</a>,
<a href=http://www.openldap.com>OpenLDAP</a>,
and 
<a href=http://www.microsoft.com>Microsoft</a>)
support External, Digest-MD5, and Kerberos V5.
<a href="http://ietf.org/rfc/rfc2829.txt">RFC 2829</a> proposes the use of Digest-MD5 
as the mandatory default mechanism for LDAP v3 servers.
<p>
Here is a <a href=examples/ServerSasl.java>simple program</a> for finding
out the list of SASL mechanisms that an LDAP server supports.
<blockquote><pre>
// Create initial context
DirContext ctx = new InitialDirContext();

// Read supportedSASLMechanisms from root DSE
Attributes attrs = ctx.getAttributes(
    "ldap://localhost:389", new String[]{"supportedSASLMechanisms"});
</pre></blockquote>
Here is the output produced by running this program
against a server that supports the External SASL mechanism.
<blockquote><pre>
{supportedsaslmechanisms=supportedSASLMechanisms: EXTERNAL, GSSAPI, DIGEST-MD5}
</pre></blockquote>

<h4>Specifying the Authentication Mechanism</h4>
<p>
To use a particular SASL mechanism, you specify its 
Internet Assigned Numbers Authority (IANA)-registered 
mechanism name in the
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#SECURITY_AUTHENTICATION"><tt>Context.SECURITY_AUTHENTICATION</tt></a>    environment property.
You can also specify a list of mechanisms
for the LDAP provider to try.
This is done
by specifying an ordered list of space-separated mechanism names.
The LDAP provider will use the first
mechanism for which it finds an implementation.
<p>
Here's an example that asks the LDAP provider to try to get
the implementation for the
DIGEST-MD5 mechanism and if that's not available,
use the one for GSSAPI.

<blockquote><pre>
env.put(Context.SECURITY_AUTHENTICATION, "DIGEST-MD5 GSSAPI");
</pre></blockquote>

You might get this list of authentication mechanisms from
the user of your application. Or you might get it
by asking the LDAP server, via a call similar to that shown previously.
The LDAP provider itself does not consult the server for this
information. It simply attempts to locate and use the implementation
of the specified mechanisms.
<p>
The LDAP provider in the platform
has built-in support for the
External, Digest-MD5, and GSSAPI (Kerberos v5) SASL mechanisms.
You can add support for additional mechanisms.

<h4>Specifying Input for the Authentication Mechanism</h4>
Some mechanisms, such as External, require no additional
input--the mechanism name alone is sufficient for the authentication
to proceed.
The <a href=ssl.html#EXTERNAL>External example</a> shows how to use
the External SASL mechanism.

<p>
Most other mechanisms require some additional input.
Depending on the mechanism, the type of input might vary. 
Following are some common inputs required by mechanisms.
<ul>
<li><b>Authentication id</b>. The identity of the entity 
performing the authentication. 
 
<li><b>Authorization id</b>. The identity of the entity
for which access control checks should be made if the authentication
succeeds.
<li><b>Authentication credentials</b>. For example, a password or a key.
</ul>
The authentication and authorization ids might differ
if the program (such as a proxy server) is authenticating on behalf
of another entity.
The authentication id is specified by using the
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#SECURITY_PRINCIPAL"><tt>Context.SECURITY_PRINCIPAL</tt></a>    environment property.
It is of type <tt>java.lang.String</tt>.
<p>
The password/key of the authentication id is specified by using the
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#SECURITY_CREDENTIALS"><tt>Context.SECURITY_CREDENTIALS</tt></a>    environment property.
It is of type <tt>java.lang.String</tt>, <tt>char</tt> array (<tt>char[]</tt>),
or <tt>byte</tt> array (<tt>byte[]</tt>).
If the password is a <tt>byte</tt> array, then it is transformed into a <tt>char</tt>
array by using an UTF-8 encoding.
<a name=authzid></a>
<p>
If the 
<tt>"java.naming.security.sasl.authorizationId"</tt>
property has been set, then its value is used as the authorization ID.
Its value must be of type <tt>java.lang.String</tt>.
By default, the empty string is used as the authorization ID, which
directs the server to derive an authorization ID from the
client's authentication credentials.
<p>
The <a href=digest.html>Digest-MD5 example</a> shows how to use the
<tt>Context.SECURITY_PRINCIPAL</tt> and <tt>Context.SECURITY_CREDENTIALS</tt>
properties for Digest-MD5 authentication.
<p>
If a mechanism requires input other than those already described,
then you need to define a <em>callback</em> object for the mechanism
to use, you can check out the callback example in the 
<a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/callback.html">JNDI Tutorial</a> <a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/callback.html"></a>.
The next part of this lesson discusses how to use SASL Digest-MD5
authentication mechanism. The 
<a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/sasl.html">SASL Policies </a> <a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/sasl.html"></a>, 
<a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/gssapi.html">GSS API (Kerberos v5) </a> <a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/gssapi.html"></a>and  
<a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/crammd5.html">CRAM-MD5 </a> <a target="_top" href="http://java.sun.com/products/jndi/tutorial/ldap/security/crammd5.html"></a>mechanisms are covered in the JNDI Tutorial.
        </blockquote>
        <div class=NavBit>
            <a target=_top href=simple.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=digest.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer>
<div id=TagNotes>
    Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://developer.sun.com/contact/tutorial_feedback.jsp">Give
    us your feedback</a>.
<br><br>
    <a target="_blank" href="../../information/copyright.html">Copyright</a>
    1995-2007 Sun Microsystems, Inc.  All rights reserved.
    <span id=Download>
</span></div> 

    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Simple
        <br><b>Next page:</b> Digest-MD5
    </div>
    </body>
</html> 
