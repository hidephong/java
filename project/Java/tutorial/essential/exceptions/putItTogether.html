<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
    <head>
        <title>Putting It All Together (The Java&trade; Tutorials &gt; 
            Essential Classes &gt; Exceptions)
</title>
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #E76F00;
        font-family: sans-serif; 
        font-weight: bold;
        font-size: 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;
        font-size: smaller;
        font-family: sans-serif; 
    }
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #E76F00;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h3, h4, h5 {
        color: #E76F00;
        font-family: sans-serif;
    }
    #ToggleLeft {
        display: none;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> Essential Classes
        <br><b>Lesson:</b> Exceptions
        <br><b>Section:</b> Catching and Handling Exceptions
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">Exceptions</a></div>
<div class="linkAHEAD"><a href="definition.html">What Is an Exception?</a></div>
<div class="linkAHEAD"><a href="catchOrDeclare.html">The Catch or Specify Requirement</a></div>
<div class="linkAHEAD"><a href="handling.html">Catching and Handling Exceptions</a></div>
<div class="linkBHEAD"><a href="try.html">The try Block</a></div>
<div class="linkBHEAD"><a href="catch.html">The catch Blocks</a></div>
<div class="linkBHEAD"><a href="finally.html">The finally Block</a></div>
<div class="nolinkBHEAD">Putting It All Together</div>
<div class="linkAHEAD"><a href="declaring.html">Specifying the Exceptions Thrown by a Method</a></div>
<div class="linkAHEAD"><a href="throwing.html">How to Throw Exceptions</a></div>
<div class="linkBHEAD"><a href="chained.html">Chained Exceptions</a></div>
<div class="linkBHEAD"><a href="creating.html">Creating Exception Classes</a></div>
<div class="linkAHEAD"><a href="runtime.html">Unchecked Exceptions &#151; The Controversy</a></div>
<div class="linkAHEAD"><a href="advantages.html">Advantages of Exceptions</a></div>
<div class="linkAHEAD"><a href="summary.html">Summary</a></div>
<div class="linkQUESTIONS"><a href="QandE/questions.html">Questions and Exercises</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>Essential Classes</a>
                &gt;
                <a href=index.html target=_top>Exceptions</a>
            </span>
            <div class=NavBit>
                <a target=_top href=finally.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=declaring.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle>Putting It All Together</div>
            <blockquote>
The previous sections described how to construct the <code>try</code>,
<code>catch</code>, and <code>finally</code> code blocks for
the <code>writeList</code> method in the <code>ListOfNumbers</code> class.  
 
Now, let's walk through the code and investigate what can happen.
<p>
When all the components are put together, the <code>writeList</code>
method looks like the following.
<blockquote><pre>
public void writeList() {
    PrintWriter out = null;

    try {
        System.out.println("Entering try statement");
        out = new PrintWriter(
	                  new FileWriter("OutFile.txt"));
            for (int i = 0; i &lt; SIZE; i++)
                out.println("Value at: " + i + " = " 
                             + vector.elementAt(i));
		  
    } catch (ArrayIndexOutOfBoundsException e) {
         System.err.println("Caught " 
                     + "ArrayIndexOutOfBoundsException: " 
                     +   e.getMessage());
				 
    } catch (IOException e) {
         System.err.println("Caught IOException: " 
                             +  e.getMessage());
				 
    } finally {
         if (out != null) {
             System.out.println("Closing PrintWriter");
             out.close();
		
         } 
         else {
             System.out.println("PrintWriter not open");
         }
     }
}
</pre></blockquote>
As mentioned previously, this method's <code>try</code> block 
has three different exit possibilities; here are two of them.
<ol>
<li>
Code in the <code>try</code> statement fails and throws an exception.
This could be an <code>IOException</code> caused by the <code>new
FileWriter</code> statement or an
<code>ArrayIndexOutOfBoundsException</code> caused by a wrong index
value in the <code>for</code> loop.

<li>
Everything succeeds and the <code>try</code> statement exits normally.
</ol>
Let's look at what happens in the <code>writeList</code> method 
during these two exit possibilities. 
</blockquote>

<h3>Scenario 1: An Exception Occurs</h3>
<blockquote>
The statement that creates a <code>FileWriter</code> can fail 
for a number of reasons. For example, the constructor for the
<code>FileWriter</code> throws an <code>IOException</code> 
if the program cannot create or write to the file indicated.
<P>
When <code>FileWriter</code> throws an <code>IOException</code>, 
the runtime system immediately stops executing the <code>try</code> block; method calls being executed are not completed. The runtime system then starts searching at the top of the method call stack for an appropriate exception handler. In this example, when the <code>IOException</code> occurs, the <code>FileWriter</code> constructor is at the top of the call stack. However, the <code>FileWriter</code> constructor doesn't have an appropriate exception handler, so the runtime system checks the next method &mdash; the <code>writeList</code> method &mdash; in the method call stack. The <code>writeList</code> 
method has two exception handlers: one for <code>IOException</code> 
and one for <code>ArrayIndexOutOfBoundsException</code>. 
<P>
The runtime system checks <code>writeList</code>'s handlers in the order 
in which they appear after the <code>try</code> statement. The argument 
to the first exception handler is <code>ArrayIndexOutOfBoundsException</code>. This does not match the type of exception thrown, so the runtime system checks the next exception handler &mdash; <code>IOException</code>. This matches the type of exception that was thrown, so the runtime system ends its search for an appropriate exception handler. Now that the runtime has found an appropriate handler, the code in that <code>catch</code> block is executed.
<P>
After the exception handler executes, the runtime system passes 
control to the <code>finally</code> block. Code in the <code>finally</code> block executes regardless of the exception caught above it. In this scenario, the <code>FileWriter</code> was never opened and doesn't need to be 
closed. After the <code>finally</code> block finishes executing, 
the program continues with the first statement after the <code>finally</code> block. 
<P>
Here's the complete output from the <code>ListOfNumbers</code> program that appears when an <code>IOException</code> is thrown. 

<blockquote><pre>
Entering try statement
Caught IOException: OutFile.txt
PrintWriter not open 
</pre></blockquote>

The boldface code in the following listing shows the statements 
that get executed during this scenario:
<blockquote><pre>
public void writeList() {
   <b>PrintWriter out = null;

    try {
        System.out.println("Entering try statement");
        out = new PrintWriter(
                   new FileWriter("OutFile.txt"));</b>
        for (int i = 0; i < SIZE; i++)
            out.println("Value at: " + i 
		        + " = " + vector.elementAt(i));
			       
    } catch (ArrayIndexOutOfBoundsException e) {
          System.err.println("Caught " 
                    + "ArrayIndexOutOfBoundsException: " 
                    + e.getMessage());
				 
    } <b>catch (IOException e) {
            System.err.println("Caught IOException: "  
                                +  e.getMessage());
				 
    } finally {
        if (out != null) {</b>
            System.out.println("Closing PrintWriter");
            out.close();
        } 
     <b>else {
            System.out.println("PrintWriter not open");
        }</b>
    }
}
</pre></blockquote>
</blockquote>

<h3>Scenario 2: The try Block Exits Normally</h3>
<blockquote>
In this scenario, all the statements within the scope of the <code>try</code> 
block execute successfully and throw no exceptions. Execution falls off the 
end of the <code>try</code> block, and the runtime system passes control 
to the <code>finally</code> block. Because everything was successful, the 
<code>PrintWriter</code> is open when control reaches the <code>finally</code> 
block, which closes the <code>PrintWriter</code>. Again, after the 
<code>finally</code> block finishes executing, the program continues 
with the first statement after the <code>finally</code> block. 
<P>
Here is the output from the <code>ListOfNumbers</code> program when no exceptions are thrown. 
 
<blockquote><pre>
Entering try statement
Closing PrintWriter
</pre></blockquote>

The boldface code in the following sample shows the statements that 
get executed during this scenario.
<blockquote><pre>
public void writeList() {
    <b>PrintWriter out = null;
    try {
        System.out.println("Entering try statement");
        out = new PrintWriter(
                  new FileWriter("OutFile.txt"));
        for (int i = 0; i < SIZE; i++)
            out.println("Value at: " + i + " = " 
                         +  vector.elementAt(i));
		  
    }</b> catch (ArrayIndexOutOfBoundsException e) {
         System.err.println("Caught " 
                     + "ArrayIndexOutOfBoundsException: " 
                     + e.getMessage());
				 
    } catch (IOException e) {
         System.err.println("Caught IOException: " 
                            + e.getMessage());
				 
    } <b>finally {
         if (out != null) {
             System.out.println("Closing PrintWriter");
             out.close();
          }</b> 
          else {
             System.out.println("PrintWriter not open");
          }
    }
}
</pre></blockquote>

        </blockquote>
        <div class=NavBit>
            <a target=_top href=finally.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=declaring.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer>
<div id=TagNotes>
    Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://developer.sun.com/contact/tutorial_feedback.jsp">Give
    us your feedback</a>.
<br><br>
    <a target="_blank" href="../../information/copyright.html">Copyright</a>
    1995-2007 Sun Microsystems, Inc.  All rights reserved.
    <span id=Download>
</span></div> 

    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> The finally Block
        <br><b>Next page:</b> Specifying the Exceptions Thrown by a Method
    </div>
    </body>
</html> 
