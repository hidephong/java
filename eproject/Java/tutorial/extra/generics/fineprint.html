<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
    <head>
        <title>The Fine Print (The Java&trade; Tutorials &gt; 
            Bonus &gt; Generics)
</title>
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #E76F00;
        font-family: sans-serif; 
        font-weight: bold;
        font-size: 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;
        font-size: smaller;
        font-family: sans-serif; 
    }
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #E76F00;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h3, h4, h5 {
        color: #E76F00;
        font-family: sans-serif;
    }
    #ToggleLeft {
        display: none;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> Bonus
        <br><b>Lesson:</b> Generics
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">Generics</a></div>
<div class="linkAHEAD"><a href="intro.html">Introduction</a></div>
<div class="linkAHEAD"><a href="simple.html">Defining Simple Generics</a></div>
<div class="linkAHEAD"><a href="subtype.html">Generics and Subtyping</a></div>
<div class="linkAHEAD"><a href="wildcards.html">Wildcards</a></div>
<div class="linkAHEAD"><a href="methods.html">Generic Methods</a></div>
<div class="linkAHEAD"><a href="legacy.html">Interoperating with Legacy Code</a></div>
<div class="nolinkAHEAD">The Fine Print</div>
<div class="linkAHEAD"><a href="literals.html">Class Literals as Runtime-Type Tokens</a></div>
<div class="linkAHEAD"><a href="morefun.html">More Fun with Wildcards</a></div>
<div class="linkAHEAD"><a href="convert.html">Converting Legacy Code to Use Generics</a></div>
<div class="linkAHEAD"><a href="acknowledgements.html">Acknowledgements</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>Bonus</a>
                &gt;
                <a href=index.html target=_top>Generics</a>
            </span>
            <div class=NavBit>
                <a target=_top href=legacy.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=literals.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle>The Fine Print</div>
            <blockquote>
<!--The Fine Print-->

<h4>A Generic Class is Shared by All Its Invocations</h4>

What does the following code fragment print?

<blockquote><pre>
List &lt;String&gt; l1 = new ArrayList&lt;String&gt;();
List&lt;Integer&gt; l2 = new ArrayList&lt;Integer&gt;();
System.out.println(l1.getClass() == l2.getClass());
</pre></blockquote>

You might be tempted to say <code>false</code>, but you'd be wrong. It prints
<code>true</code>, because all instances of a generic class have the same
run-time class, regardless of their actual type parameters.
<P>
Indeed, what makes a class generic is the fact that it has the same behavior
for all of its possible type parameters; the same class can be viewed as  
having many different types.
<P>
As consequence, the static variables and methods of a class are also
shared among all the instances. That is why it is illegal to refer to
the type parameters of a type declaration in a static method or initializer,
or in the declaration or initializer of a static variable.

<h4>Casts and InstanceOf</h4>

Another implication of the fact that a generic class is shared among all its 
instances, is that it usually makes no sense to ask an instance if it is
an instance of a particular invocation of a generic type:

<blockquote><pre>
Collection cs = new ArrayList&lt;String&gt;();
if (cs <b>instanceof</b> Collection&lt;String&gt;) { ...} // <i>Illegal.</i>
</pre></blockquote>

similarly, a cast such as

<blockquote><pre>
Collection&lt;String&gt; cstr = (Collection&lt;String&gt;) cs; // <i>Unchecked warning,</i>
</pre></blockquote>

gives an unchecked warning, since this isn't something the runtime system is
going to check for you.
<P>
The same is true of type variables

<blockquote><pre>
&lt;T&gt; T badCast(T t, Object o) {<b>return</b> (T) o; // <i>Unchecked warning.</i> 
    }
</pre></blockquote>

Type variables don't exist at run time. This means that they entail no 
performance overhead in either time nor space, which is nice. Unfortunately,
it also means that you can't reliably use them in casts.

<h4>Arrays</h4>

The component type of an array object may not be a type variable or a parameterized type, unless
it is an (unbounded) wildcard type.You can declare array <i>types</i> whose 
element type is a type variable or a parameterized type, but not array <i>objects</i>.
<P>
This is annoying, to be sure. This restriction is necessary to avoid
situations like:

<blockquote><pre>
List&lt;String&gt;[] lsa = new List&lt;String&gt;[10]; // <i>Not really allowed.</I>
Object o = lsa;
Object[] oa = (Object[]) o;
List&lt;Integer&gt; li = new ArrayList&lt;Integer&gt;();
li.add(new Integer(3));
oa[1] = li; // <i>Unsound, but passes run time store check </i>
String s = lsa[1].get(0); // <i>Run-time error: ClassCastException.</I>
</pre></blockquote>

If arrays of parameterized type were allowed, the example above would compile 
without any unchecked warnings, and yet fail at run-time. We've had type-safety
as a primary design goal of generics. In particular, the language is
designed to guarantee
that <b>if your entire application
has been compiled without unchecked warnings using <tt>javac -source 1.5</tt>,
it is type safe</b>. 
<P>
However, you can still use wildcard arrays. Here are two variations 
on the code above. The first forgoes the use of both array objects 
and array types whose element type is parameterized. As a result, 
we have  to cast explicitly to get a <code>String</code> out of the array. 

<blockquote><pre>
List&lt;?&gt;[] lsa = new List&lt;?&gt;[10]; // <i>OK, array of unbounded wildcard type.</i>
Object o = lsa;
Object[] oa = (Object[]) o;
List&lt;Integer&gt; li = new ArrayList&lt;Integer&gt;();
li.add(new Integer(3));
oa[1] = li; // <i>Correct.</i>
String s = (String) lsa[1].get(0); // <i>Run time error, but cast is explicit.</i>
</pre></blockquote>

In the next variation, we refrain from creating an array object 
whose element type is parameterized, but still use an array type 
with a parameterized element type. This is legal, but generates an unchecked
warning. Indeed, the code is unsafe, and eventually an error occurs.

<blockquote><pre>
List&lt;String&gt;[] lsa = new List&lt;?&gt;[10]; // <i>Unchecked warning. This is unsafe!</i>
Object o = lsa;
Object[] oa = (Object[]) o;
List&lt;Integer&gt; li = new ArrayList&lt;Integer&gt;();
li.add(new Integer(3));
oa[1] = li; // <i>Correct.</i>
String s = lsa[1].get(0); // <i>Run time error, but we were warned.</i>
</pre></blockquote>

Similarly, attempting to create an array object whose element 
type is a type variable causes a compile-time error:

<blockquote><pre>
&lt;T&gt; T[] makeArray(T t) {
    <b>return</b> new T[100]; // <i>Error.</i>
}
</pre></blockquote>

Since type variables
don't exist at run time, there is no way to determine what the actual
array type would be. 
<P>
The way to work around these kinds of limitations is to use class literals
as run time type tokens, as described in the next section, 
<a class="TutorialLink" target="_top" href="literals.html">Class Literals as Runtime-Type Tokens</a>.


        </blockquote>
        <div class=NavBit>
            <a target=_top href=legacy.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=literals.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer>
<div id=TagNotes>
    Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://developer.sun.com/contact/tutorial_feedback.jsp">Give
    us your feedback</a>.
<br><br>
    <a target="_blank" href="../../information/copyright.html">Copyright</a>
    1995-2007 Sun Microsystems, Inc.  All rights reserved.
    <span id=Download>
</span></div> 

    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Interoperating with Legacy Code
        <br><b>Next page:</b> Class Literals as Runtime-Type Tokens
    </div>
    </body>
</html> 
