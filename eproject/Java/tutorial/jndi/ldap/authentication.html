



<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
    <head>
        <title>Modes of Authenticating to LDAP (The Java&trade; Tutorials &gt; 
            Java Naming and Directory Interface(TM). &gt; Advanced Topics for LDAP Users)
</title>
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #E76F00;
        font-family: sans-serif; 
        font-weight: bold;
        font-size: 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;
        font-size: smaller;
        font-family: sans-serif; 
    }
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #E76F00;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h3, h4, h5 {
        color: #E76F00;
        font-family: sans-serif;
    }
    #ToggleLeft {
        display: none;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> Java Naming and Directory Interface(TM).
        <br><b>Lesson:</b> Advanced Topics for LDAP Users
        <br><b>Section:</b> Security
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">Advanced Topics for LDAP Users</a></div>
<div class="linkAHEAD"><a href="ldap.html">LDAP v3</a></div>
<div class="linkAHEAD"><a href="jndi.html">JNDI as an LDAP API</a></div>
<div class="linkBHEAD"><a href="operations.html">How LDAP Operations Map to JNDI APIs</a></div>
<div class="linkBHEAD"><a href="exceptions.html">How LDAP Error Codes Map to JNDI Exceptions</a></div>
<div class="linkAHEAD"><a href="security.html">Security</a></div>
<div class="nolinkBHEAD">Modes of Authenticating to LDAP</div>
<div class="linkBHEAD"><a href="auth_mechs.html">Authentication Mechanisms</a></div>
<div class="linkBHEAD"><a href="anonymous.html">Anonymous</a></div>
<div class="linkBHEAD"><a href="simple.html">Simple</a></div>
<div class="linkBHEAD"><a href="sasl.html">SASL</a></div>
<div class="linkBHEAD"><a href="digest.html">Digest-MD5</a></div>
<div class="linkBHEAD"><a href="ssl.html">SSL and Custom Sockets</a></div>
<div class="linkAHEAD"><a href="rename.html">More LDAP Operations</a></div>
<div class="linkBHEAD"><a href="compare.html">LDAP Compare</a></div>
<div class="linkBHEAD"><a href="result.html">Search Results</a></div>
<div class="linkBHEAD"><a href="unsol.html"> LDAP Unsolicited Notifications</a></div>
<div class="linkAHEAD"><a href="connect.html">Connection Management</a></div>
<div class="linkBHEAD"><a href="create.html">Creation</a></div>
<div class="linkBHEAD"><a href="close.html"> Closing</a></div>
<div class="linkBHEAD"><a href="pool.html">Pooling</a></div>
<div class="linkBHEAD"><a href="config.html">Configuration</a></div>
<div class="linkAHEAD"><a href="faq.html">Frequently Asked Questions</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>Java Naming and Directory Interface(TM).</a>
                &gt;
                <a href=index.html target=_top>Advanced Topics for LDAP Users</a>
            </span>
            <div class=NavBit>
                <a target=_top href=security.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=auth_mechs.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle>Modes of Authenticating to LDAP</div>
            <blockquote>
In the LDAP, authentication information is supplied in the
"bind" operation. In LDAP v2, a client initiates a connection with
the LDAP server by sending the server 
a "bind" operation that contains the authentication information.
<p>
In the LDAP v3, this operation serves the same purpose, but it is optional.
A client that sends an LDAP request without doing a "bind" is
treated as an <em>anonymous</em> client (see the
<a href=anonymous.html>Anonymous Authentication</a> section for details).
In the LDAP v3, the "bind" operation  may be sent at any time, 
possibly more than once, during the connection.
A client can send a "bind" request in the middle of a connection to
change its identity. If the request is successful, then all outstanding
requests that use the old identity on the connection are discarded
and the connection is associated with the new identity.
<p>
The authentication information supplied in the "bind" operation depends on the
<em>authentication mechanism</em> that the client chooses. 
See <a href=auth_mechs.html>the next section</a>
for a discussion of the authentication mechanism.
<p>

<h4>Authenticating to the LDAP by Using the JNDI</h4>
In the JNDI, authentication information is specified in environment properties.
When you create an initial context by using the 
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/directory/InitialDirContext.html"><tt>InitialDirContext</tt></a>     class (or its superclass or subclass), 
you supply a set of environment properties, some of which might
contain authentication information.
You can use the following environment properties 
to specify the authentication information.
<ul>
<li>
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#SECURITY_AUTHENTICATION"><tt>Context.SECURITY_AUTHENTICATION</tt></a>  (<tt>"java.naming.security.authentication"</tt>).
<br>
Specifies the authentication mechanism to use.
For the Sun LDAP service provider, this can be one of the following strings:
<tt>"none"</tt>, <tt>"simple"</tt>, <em>sasl_mech</em>,
where <em>sasl_mech</em> is a space-separated list of SASL mechanism names.
See the <a href=auth_mechs.html>next section</a> for a description of these strings.
<li><br>
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#SECURITY_PRINCIPAL"><tt>Context.SECURITY_PRINCIPAL</tt></a>  (<tt>"java.naming.security.principal"</tt>).
<br>
Specifies the name of the user/program doing the authentication
and depends on the value of the <tt>Context.SECURITY_AUTHENTICATION</tt>
property. See the next few sections in this lesson
for details and examples.
<li><br>
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#SECURITY_CREDENTIALS"><tt>Context.SECURITY_CREDENTIALS</tt></a>  (<tt>"java.naming.security.credentials"</tt>).
<br>
Specifies the credentials of the user/program doing the authentication
and depends on the value of the <tt>Context.SECURITY_AUTHENTICATION</tt>
property. See the next few sections in this lesson
for details and examples.
</ul>

When the initial context is created, the underlying LDAP service provider
extracts the authentication information from these environment properties and
uses the LDAP "bind" operation to pass them to the server.
<p>
<a name=SIMPLE></a>
The <a href=examples/Simple.java>following example</a> shows how,
by using a simple clear-text password, a client authenticates to an LDAP server.
<blockquote><pre>
// Set up the environment for creating the initial context
Hashtable<String, Object> env = new Hashtable<String, Object>();
env.put(Context.INITIAL_CONTEXT_FACTORY, 
    "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=JNDITutorial");

// Authenticate as S. User and password "mysecret"
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, "cn=S. User, ou=NewHires, o=JNDITutorial");
env.put(Context.SECURITY_CREDENTIALS, "mysecret");

// Create the initial context
DirContext ctx = new InitialDirContext(env);

// ... do something useful with ctx
</blockquote></pre>

<h4>Using Different Authentication Information for a Context</h4>
If you want to use different authentication information for an existing
context, then you can use
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#addToEnvironment(java.lang.String, java.lang.Object)"><tt>Context.addToEnvironment()</tt></a>     and
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/Context.html#removeFromEnvironment(java.lang.String)"><tt>Context.removeFromEnvironment()</tt></a>    to update the environment properties
that contain the authentication information. Subsequent invocations of methods
on the context will use the new authentication information to
communicate with the server.
<p>
The <a href=examples/UseDiff.java>following example</a> shows how the
authentication information of a context is changed to <tt>"none"</tt>
after the context has been created.
<blockquote><pre>
// Authenticate as S. User and the password "mysecret"
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, "cn=S. User, ou=NewHires, o=JNDITutorial");
env.put(Context.SECURITY_CREDENTIALS, "mysecret");

// Create the initial context
DirContext ctx = new InitialDirContext(env);

// ... do something useful with ctx

// Change to using no authentication
ctx.addToEnvironment(Context.SECURITY_AUTHENTICATION, "none");

// ... do something useful with ctx
</pre></blockquote>

<h4>Authentication Failures</h4>

Authentication can fail for a number of reasons.
For example,
if you supply incorrect authentication information, such as an incorrect
password or principal name, then an
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/AuthenticationException.html"><tt>AuthenticationException</TT></a>     is thrown.
<p>
Here's <a href=examples/BadPasswd.java>an example</a> that is a variation of
the previous example. This time, an incorrect password causes
the authentication to fail.
<blockquote><pre>
// Authenticate as S. User and give an incorrect password
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, "cn=S. User, ou=NewHires, o=JNDITutorial");
env.put(Context.SECURITY_CREDENTIALS, "notmysecret");
</pre></blockquote>
This produces the following output.
<blockquote><pre>
javax.naming.AuthenticationException: [LDAP: error code 49 - Invalid Credentials]
	...
</pre></blockquote>
<p>
Because different servers support different authentication mechanisms,
you might request an authentication mechanism that the server 
does not support. In this case, an
<a class="APILink" target="_blank" href="http://java.sun.com/javase/6/docs/api/javax/naming/AuthenticationNotSupportedException.html"><tt>AuthenticationNotSupportedException</TT></a>    will be thrown.
<p>
Here's <a href=examples/BadAuth.java>an example</a> that is a variation of
the previous example. This time, an unsupported authentication mechanism 
(<tt>"custom"</tt>) causes the authentication to fail.
<blockquote><pre>
// Authenticate as S. User and the password "mysecret"
env.put(Context.SECURITY_AUTHENTICATION, "custom");
env.put(Context.SECURITY_PRINCIPAL, "cn=S. User, ou=NewHires, o=JNDITutorial");
env.put(Context.SECURITY_CREDENTIALS, "mysecret");
</pre></blockquote>
This produces the following output.
<blockquote><pre>
javax.naming.AuthenticationNotSupportedException: custom
	...
</pre></blockquote>
        </blockquote>
        <div class=NavBit>
            <a target=_top href=security.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=auth_mechs.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer>
<div id=TagNotes>
    Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://developer.sun.com/contact/tutorial_feedback.jsp">Give
    us your feedback</a>.
<br><br>
    <a target="_blank" href="../../information/copyright.html">Copyright</a>
    1995-2007 Sun Microsystems, Inc.  All rights reserved.
    <span id=Download>
</span></div> 

    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Security
        <br><b>Next page:</b> Authentication Mechanisms
    </div>
    </body>
</html> 
