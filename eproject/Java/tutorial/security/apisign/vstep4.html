<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
    <head>
        <title>Verify the Signature (The Java&trade; Tutorials &gt; 
            Security Features in Java SE &gt; Generating and Verifying Signatures)
</title>
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #E76F00;
        font-family: sans-serif; 
        font-weight: bold;
        font-size: 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;
        font-size: smaller;
        font-family: sans-serif; 
    }
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #E76F00;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h3, h4, h5 {
        color: #E76F00;
        font-family: sans-serif;
    }
    #ToggleLeft {
        display: none;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> Security Features in Java SE
        <br><b>Lesson:</b> Generating and Verifying Signatures
        <br><b>Section:</b> Verifying a Digital Signature
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">Generating and Verifying Signatures</a></div>
<div class="linkAHEAD"><a href="gensig.html">Generating a Digital Signature</a></div>
<div class="linkBHEAD"><a href="step1.html">Prepare Initial Program Structure</a></div>
<div class="linkBHEAD"><a href="step2.html">Generate Public and Private Keys</a></div>
<div class="linkBHEAD"><a href="step3.html">Sign the Data</a></div>
<div class="linkBHEAD"><a href="step4.html">Save the Signature and the Public Key in Files</a></div>
<div class="linkBHEAD"><a href="step5.html">Compile and Run the Program</a></div>
<div class="linkAHEAD"><a href="versig.html">Verifying a Digital Signature</a></div>
<div class="linkBHEAD"><a href="vstep1.html">Prepare Initial Program Structure</a></div>
<div class="linkBHEAD"><a href="vstep2.html">Input and Convert the Encoded Public Key Bytes</a></div>
<div class="linkBHEAD"><a href="vstep3.html">Input the Signature Bytes</a></div>
<div class="nolinkBHEAD">Verify the Signature</div>
<div class="linkBHEAD"><a href="vstep5.html">Compile and Run the Program</a></div>
<div class="linkAHEAD"><a href="enhancements.html">Weaknesses and Alternatives</a></div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>Security Features in Java SE</a>
                &gt;
                <a href=index.html target=_top>Generating and Verifying Signatures</a>
            </span>
            <div class=NavBit>
                <a target=_top href=vstep3.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=vstep5.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle>Verify the Signature</div>
            <blockquote>
<p>You've added code to the <code>VerSig</code> program to

<ul>

<li>Input the encoded key bytes and converted them
to a <code>PublicKey</code> named <code>pubKey</code><p>
<li>Input the signature bytes into a byte array named <code>sigToVerify</code>

</ul>

You can now proceed to do the verification.


<p><b>Initialize the Signature Object for Verification</b>

<blockquote>

<p>As with signature generation, a signature is verified by
using an instance of the <code>Signature</code> class. 
You need to create a <code>Signature</code> object that uses the same signature algorithm
as was used to generate the signature. The algorithm used by the
<code>GenSig</code> program was the SHA1withDSA algorithm from the SUN
provider.

<blockquote><pre>
Signature sig = Signature.getInstance("SHA1withDSA", "SUN");
</pre></blockquote>

Next, you need to initialize the <code>Signature</code> object.
The initialization method for verification requires the public key.

<blockquote><pre>
sig.initVerify(pubKey);
</pre></blockquote>

</blockquote>


<p><b>Supply the Signature Object With the Data to be Verified</b>

<blockquote>

You now need to supply the <code>Signature</code> object with the data for which
a signature was generated. This data is in the file whose name was
specified as the third command line argument. As you did
when signing, read in the data one buffer at a time, and supply it to
the <code>Signature</code> object by calling the <code>update</code> method.

<blockquote><pre>
FileInputStream datafis = new FileInputStream(args[2]);
BufferedInputStream bufin = new BufferedInputStream(datafis);

byte[] buffer = new byte[1024];
int len;
while (bufin.available() != 0) {
    len = bufin.read(buffer);
    sig.update(buffer, 0, len);
};

bufin.close();
</pre></blockquote>

</blockquote>

<p><b>Verify the Signature</b>

<blockquote>

<p>Once you have supplied all of the data to the <code>Signature</code> object,
you can verify the digital signature of that data and report
the result. Recall that
the alleged signature was read into a byte array called <code>sigToVerify</code>.

<blockquote><pre>
boolean verifies = sig.verify(sigToVerify);

System.out.println("signature verifies: " + verifies);
</pre></blockquote>

<p>The <code>verifies</code> value will be <code>true</code> if
the alleged signature (<code>sigToVerify</code>) is the actual signature of the
specified data file generated by the private key corresponding to the
public key <code>pubKey</code>.

</blockquote>



        </blockquote>
        <div class=NavBit>
            <a target=_top href=vstep3.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=vstep5.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer>
<div id=TagNotes>
    Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://developer.sun.com/contact/tutorial_feedback.jsp">Give
    us your feedback</a>.
<br><br>
    <a target="_blank" href="../../information/copyright.html">Copyright</a>
    1995-2007 Sun Microsystems, Inc.  All rights reserved.
    <span id=Download>
</span></div> 

    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Input the Signature Bytes
        <br><b>Next page:</b> Compile and Run the Program
    </div>
    </body>
</html> 
