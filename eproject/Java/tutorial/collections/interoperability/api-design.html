
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
    <head>
        <title>API Design (The Java&trade; Tutorials &gt; 
            Collections &gt; Interoperability)
</title>
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: center;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #E76F00;
        font-family: sans-serif; 
        font-weight: bold;
        font-size: 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;
        font-size: smaller;
        font-family: sans-serif; 
    }
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #E76F00;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h3, h4, h5 {
        color: #E76F00;
        font-family: sans-serif;
    }
    #ToggleLeft {
        display: none;
    }

    /t

</style>
<script type="text/javascript">
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide the TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }
    
</script>

    </head>
<body onload="load()">
    <div id=TopBar> <div id=TopBar_tr> <div id=TopBar_tl> <div id=TopBar_br> <div id=TopBar_bl> 
                        <div id=TopBar_right> 
                            <a target="_blank"
                                href="http://java.sun.com/javase/6/download.jsp">Download
                                the JDK</a>
                            <br>
                            <a href="../../search.html" target="_blank">Search the
                                Tutorials</a>
                            <br>
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide the TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class=PrintHeaders>
        <b>Trail:</b> Collections
        <br><b>Lesson:</b> Interoperability
    </div>

    <div id=LeftBar class=LeftBar_shown>
        <div id=Contents>
            <div class="linkLESSON"><a href="index.html">Interoperability</a></div>
<div class="linkAHEAD"><a href="compatibility.html">Compatibility</a></div>
<div class="nolinkAHEAD">API Design</div>
</div>
    </div>
    <div id=MainFlow class=MainFlow_indented>
            <span id=BreadCrumbs>
                <a href=../../index.html target=_top>Home Page</a>
                &gt;
                <a href=../index.html target=_top>Collections</a>
                &gt;
                <a href=index.html target=_top>Interoperability</a>
            </span>
            <div class=NavBit>
                <a target=_top href=compatibility.html>&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target=_top href=../TOC.html>Trail</a>&nbsp;&bull;&nbsp;<a target=_top href=../end.html>Next&nbsp;&raquo;</a>
            </div>
            <div id=PageTitle>API Design</div>
            <blockquote>
In this short but important section, you'll learn a few simple
guidelines that will allow your API to interoperate seamlessly
with all other APIs that follow these guidelines. In essence,
these rules define what it takes to be a good "citizen" in the world
of collections.

</blockquote>

<h3 fmstyle=D-Head>Parameters</h3>

<blockquote>

If your API contains a method that requires a collection on input,
it is of paramount importance that you declare the relevant parameter
type to be one of the collection
<a class="TutorialLink" target="_top" href="../interfaces/index.html">interface</a> types. <b>Never</b> use an
<a class="TutorialLink" target="_top" href="../implementations/index.html">implementation</a> type because this defeats the purpose of an interface-based
Collections Framework, which is to allow collections to be
manipulated without regard to implementation details.

<p>

Further, you should always use the least-specific type that makes sense.
For example, don't require a
<a class="TutorialLink" target="_top" href="../interfaces/list.html"><code>List</code></a> or a
<a class="TutorialLink" target="_top" href="../interfaces/set.html"><code>Set</code></a> if a
<a class="TutorialLink" target="_top" href="../interfaces/collection.html"><code>Collection</code></a> would do. It's not that you should never require a <code>List</code>
or a <code>Set</code> on input; it is correct to do so if a method
depends on a property of one of these interfaces. For example,
many of the algorithms provided by the Java platform require a
<code>List</code> on input because they depend on the fact that lists
are ordered. As a general rule, however, the best types to use on
input are the most general: <code>Collection</code> and <code>Map</code>.

<blockquote><hr><strong><FONT COLOR="red">Caution</FONT>:</strong>&nbsp;Never define your own ad hoc <code>collection</code> class and require objects
of this class on input. By doing this, you'd lose all the
<a class="TutorialLink" target="_top" href="../intro/index.html">benefits provided by the Java Collections Framework</a>. 

<hr></blockquote>

</blockquote>

<h3 fmstyle=D-Head>Return Values</h3>

<blockquote>

You can afford to be much more flexible with return values than with
input parameters. It's fine to return an object of any type that
implements or extends one of the collection interfaces. This can be
one of the interfaces or a special-purpose type that extends or
implements one of these interfaces.

<p>

For example, one could imagine an image-processing package, called <code>ImageList</code>, that returned objects of a new class that implements <code>List</code>. In addition to the <code>List</code> operations,
<code>ImageList</code> could support any application-specific operations
that seemed desirable. For example, it might provide an
<code>indexImage</code> operation that returned an image containing thumbnail
images of each graphic in the <code>ImageList</code>. It's critical to
note that even if the API furnishes <code>ImageList</code> instances
on output, it should accept arbitrary <code>Collection</code> (or
perhaps <code>List</code>) instances on input.

<p>

In one sense, return values should have the opposite behavior of
input parameters: It's best to return the most specific applicable
collection interface rather than the most general. For example,
if you're sure that you'll always return a <code>SortedMap</code>,
you should give the relevant method the return type of
<code>SortedMap</code> rather than <code>Map</code>. <code>SortedMap</code>
instances are more time-consuming to build than ordinary
<code>Map</code> instances and are also more powerful. Given that your
module has already invested the time to build a <code>SortedMap</code>,
it makes good sense to give the user access to its increased power.
Furthermore, the user will be able to pass the returned object to methods
that demand a <code>SortedMap</code>, as well as those that accept any <code>Map</code>.

</blockquote>

<h3 fmstyle=D-Head>Legacy APIs</h3>

<blockquote>

There are currently plenty of APIs out there that define their own
ad hoc collection types. While this is unfortunate, it's a fact of life,
given that there was no Collections Framework in the first two major
releases of the Java platform. Suppose you own one of these APIs;
here's what you can do about it.

<p>

If possible, retrofit your legacy collection type to implement one
of the standard collection interfaces. Then all the collections you return will interoperate smoothly with other collection-based
APIs. If this is impossible (for example, because one or more of the
preexisting type signatures conflict with the standard collection
interfaces), define an <em>adapter class</em> that wraps one of your
legacy collections objects, allowing it to function as a standard
collection. (The <code>Adapter</code> class is an example of a
<a class="TutorialLink" target="_top" href="../custom-implementations/index.html"><em>custom implementation</em></a>.)

<p>

Retrofit your API with new calls that follow the input guidelines
to accept objects of a standard collection interface, if possible.
Such calls can coexist with the calls that take the legacy collection type.
If this is impossible, provide a constructor or static factory for
your legacy type that takes an object of one of the standard interfaces
and returns a legacy collection containing the same elements
(or mappings). Either of these approaches will allow users to pass
arbitrary collections into your API. 

        </blockquote>
        <div class=NavBit>
            <a target=_top href=compatibility.html>&laquo; Previous</a>
            &bull;
            <a target=_top href=../TOC.html>Trail</a>
            &bull;
            <a target=_top href=../end.html>Next &raquo;</a>
        </div>
    </div>
    <div id=Footer>
<div id=TagNotes>
    Problems with the examples? Try <a target="_blank"
        href=../../information/run-examples.html>Compiling and Running
        the Examples: FAQs</a>.
    <br>
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://developer.sun.com/contact/tutorial_feedback.jsp">Give
    us your feedback</a>.
<br><br>
    <a target="_blank" href="../../information/copyright.html">Copyright</a>
    1995-2007 Sun Microsystems, Inc.  All rights reserved.
    <span id=Download>
</span></div> 

    </div>
    <div class=PrintHeaders>
        <b>Previous page:</b> Compatibility
        <br><b>Next page:</b> End of Trail
    </div>
    </body>
</html> 
